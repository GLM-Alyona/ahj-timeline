(()=>{"use strict";class t{constructor(t,e){this.postText=t,this.coords=e,this.date=new Date}render(){return this.postEl=document.createElement("li"),this.postEl.className="feed__post post-feed",this.postDateEl=document.createElement("span"),this.postDateEl.className="post-feed__date",this.postDateEl.textContent=`${this.formatDate()}`,this.postTextEl=document.createElement("span"),this.postTextEl.className="post-feed__text",this.postTextEl.textContent=this.postText,this.postCoordsEl=document.createElement("span"),this.postCoordsEl.className="post-feed__coords",this.postCoordsEl.textContent=this.coords,this.postEl.appendChild(this.postDateEl),this.postEl.appendChild(this.postTextEl),this.postEl.appendChild(this.postCoordsEl),this.postEl}formatDate(){return`${this.date.getDate()<10?`0${this.date.getDate()}`:this.date.getDate()}.${this.date.getMonth()<10?`0${this.date.getMonth()}`:this.date.getMonth()}.${String(this.date.getFullYear()).slice(-2)} ${this.date.getHours()<10?`0${this.date.getHours()}`:this.date.getHours()}:${this.date.getMinutes()<10?`0${this.date.getMinutes()}`:this.date.getMinutes()}`}}window.onload=()=>{const e=document.getElementById("feed-form"),s=document.querySelector(".feed__posts"),o=document.querySelector(".warning-popup"),n=document.getElementById("form-warning");let i;e.reset(),n.reset(),e.addEventListener("submit",(r=>{r.preventDefault(),i=e.querySelector("#post").value,navigator.geolocation&&navigator.geolocation.getCurrentPosition((o=>{const n=`[${o.coords.latitude.toFixed(5)}, ${o.coords.longitude.toFixed(5)}]`;s.appendChild(new t(i,n).render()),e.reset()}),(t=>{o.classList.remove("hidden"),e.reset(),n.querySelector(".form-warning__hint")&&n.querySelector(".form-warning__hint").remove()}))})),n.addEventListener("submit",(e=>{e.preventDefault();let r=n.querySelector("#coords-input").value;if(/^(\[|\[-|-|)\d{1,3}\.\d{5},( |)(-|)\d{1,3}\.\d{5}(\]|)$/.test(r))n.querySelector(".form-warning__hint")&&n.querySelector(".form-warning__hint").remove(),/[\[\]]/g.test(r)||(r=`[${r}]`),s.appendChild(new t(i,r).render()),n.reset(),o.classList.add("hidden");else{const t=document.createElement("span");t.className="form-warning__hint",t.textContent="Некорректно введены значения координат (координаты должны содержать 5 символов после точки, между координатами можеть быть не больше одного пробела.)",n.appendChild(t)}})),n.querySelector(".cancel-btn").addEventListener("click",(t=>{t.preventDefault(),o.classList.add("hidden"),n.reset()}))}})();